!function(){function e(e,n,i,r,d){function l(t,l,s,c){function u(){var o="<div class='auto-complete-container' data-instance-id='{{ctrl.instanceId}}' ng-show='ctrl.containerVisible'><ul class='auto-complete-results'><li ng-repeat='item in ctrl.renderItems'ng-click='ctrl.selectItem($index, true)' class='auto-complete-item' data-index='{{$index}}' ng-class='ctrl.isSelected($index)'><div ng-bind-html='item.label'></div></li></ul></div>",i=e(o);m.container=i(t),angular.isDefined(m.options.containerCssClass)&&m.container.addClass(m.options.containerCssClass),angular.isDefined(m.options.dropdownParent)?m.options.dropdownParent.append(m.container):(n.find("body").append(m.container),m.container.addClass("auto-complete-absolute-container")),m.target=l,m.elementUL=angular.element(m.container[0].querySelector("ul.auto-complete-results")),m.container.css("MozUserSelect","none").bind("selectstart",function(){return!1})}function p(e){var t=e.charCode||e.keyCode||0;if(t==o.UPARROW)return m.scrollToItem(-1),e.stopPropagation(),void e.preventDefault();if(t==o.DOWNARROW)return m.scrollToItem(1),e.stopPropagation(),void e.preventDefault();if(t==o.ENTER)return m.confirm(),e.preventDefault(),void e.stopPropagation();if(t==o.ESCAPE)return m.hide(),e.preventDefault(),void e.stopPropagation();var n=l.val();if(n.length>=m.options.minimumChars&&n!==m.selectedText())var i=r(function(){n==l.val()&&m.fetch(n),r.cancel(i)},300);else m.hide(),m.empty()}function f(e){d.hideIfInactive()}function h(e){d.hideIfInactive();var t=!1;try{if(m.instanceId!==m.activeInstanceId())return;var n=m.container[0].getBoundingClientRect(),o=30;(e.pageX<n.left-o||e.pageX>n.left+n.width+o||e.pageY<n.top-o||e.pageY>n.top+n.height+o)&&(t=!0,n=m.target[0].getBoundingClientRect(),e.pageX>=n.left&&e.pageX<=n.left+n.width&&e.pageY>=n.top&&e.pageY<=n.top+n.height&&(t=!1),t&&m.hide())}catch(e){}}var m=c[0];m.textModelCtrl=c[1],d.addDirectiveCtrl(m);var g=m.options()||{};m.init(angular.extend({},a,g)),u(),l.on("focus",function(e){t.$evalAsync(function(){m.activate()})}),l.on("keydown",function(e){t.$evalAsync(function(){p(e)})}),n.on("keydown",function(e){t.$evalAsync(function(){f(e)})}),angular.element(i).on("resize",function(e){t.$evalAsync(function(){m.hide()})}),n.on("click",function(e){t.$evalAsync(function(){h(e)})}),t.$on("$destroy",function(){m.empty(),m.container.remove()})}return{restrict:"A",scope:{},transclude:!1,controllerAs:"ctrl",bindToController:{options:"&autoComplete"},require:["autoComplete","ngModel"],link:l,controller:t}}function t(e,t,n,o,a){function d(e,t){if(angular.isFunction(e))try{return e.call(m.target,t)}catch(n){}}function l(){if(!angular.isDefined(m.options.dropdownParent)){var e=m.target[0].getBoundingClientRect();if("auto"==m.options.dropdownWidth?m.container.css({width:e.width+"px"}):m.container.css({width:m.options.dropdownWidth}),"auto"!==m.options.dropdownHeight&&m.elementUL.css({height:m.options.dropdownHeight}),window.jQuery&&window.jQuery.ui)m.container.position({my:"left top",at:"left bottom",of:m.target,collision:"none flip"});else{var o=n[0].body.scrollTop||n[0].documentElement.scrollTop||t.pageYOffset,i=n[0].body.scrollLeft||n[0].documentElement.scrollLeft||t.pageXOffset;m.container.css({left:e.left+i+"px"}),m.container.css({top:e.top+e.height+o+"px"})}}}function s(){if(-1!==m.selectedIndex){var e,t=m.renderItems[m.selectedIndex];return e=angular.isString(t.data)?t.data:t.value,c(e),t.data}}function c(e){e!==m.textModelCtrl.$modelValue&&(m.textModelCtrl.$setViewValue(e),m.textModelCtrl.$render(),p=e)}function u(e){return{value:e,label:o.trustAsHtml("<span>"+e+"</span>")}}var p,f,h=0,m=this;this.target=null,this.selectedIndex=-1,this.renderItems=[],this.containerVisible=!1,this.activeInstanceId=function(){return h},this.hideIfInactive=function(){angular.isDefined(m.options.dropdownParent)||m.instanceId!==h&&m.hide()},this.init=function(e){this.options=e,this.instanceId=++i},this.activate=function(){h=m.instanceId},this.fetch=function(t){d(m.options.loading),e.when(m.options.data(t),function(e){var n=m.textModelCtrl.$viewValue;t==n&&(m.renderList(e,t),d(m.options.loadingComplete))},function(e){m.hide(),d(m.options.loadingComplete,{error:e})})},this.renderList=function(e){if(m.empty(),!angular.isDefined(e)||0===e.length)return void m.hide();var t=null;t=angular.isFunction(m.options.renderItem)&&m.options.renderItem!==angular.noop?m.options.renderItem:u;for(var n=e.length<m.options.maxItemsToRender?e.length:m.options.maxItemsToRender,o=0;n>o;o++){var i=e[o],a=t(i);null!==a&&angular.isDefined(a)&&(a.data=i,m.renderItems.push(a))}m.show()},this.show=function(){l(),m.containerVisible=!0,d(m.options.dropdownShown)},this.hide=function(){m.containerVisible!==!1&&(m.elementUL[0].scrollTop=0,m.containerVisible=!1,d(m.options.dropdownHidden))},this.empty=function(){m.selectedIndex=-1,m.renderItems=[]},this.scrollToItem=function(e){if(m.containerVisible!==!1){var t=m.selectedIndex+e,n=m.renderItems[t];if(n)if(m.selectItem(t),window.jQuery){var o=m.elementUL.find("li[data-index='"+t+"']");jQuery.scrollTo&&m.elementUL.scrollTo(o)}else{var o=m.elementUL[0].querySelector("li[data-index='"+t+"']");o&&(m.elementUL[0].scrollTop=o.offsetTop)}}},this.selectItem=function(e,t){var n=m.renderItems[e];angular.isDefined(n)&&(m.selectedIndex=e,t===!0?m.confirm():s())},this.confirm=function(){m.containerVisible!==!1&&(m.hide(),f=s(),d(m.options.itemSelected,{item:f}))},this.isSelected=function(e){return e==m.selectedIndex?m.options.selectedCssClass:""},this.selectedText=function(){return p},a.defaultOptionsDoc=function(){return r}}function n(){var e=[];this.addDirectiveCtrl=function(t){t&&e.push(t)},this.hideIfInactive=function(t){angular.forEach(e,function(e){e.hideIfInactive()})}}angular.module("autoCompleteModule",["ngSanitize"]).service("autoCompleteService",n).directive("autoComplete",e),e.$inject=["$compile","$document","$window","$timeout","autoCompleteService"],t.$inject=["$q","$window","$document","$sce","autoCompleteService"];var o={ENTER:13,ESCAPE:27,UPARROW:38,DOWNARROW:40},i=0,a={containerCssClass:"",selectedCssClass:"auto-complete-item-selected",minimumChars:"1",maxItemsToRender:20,dropdownWidth:"auto",dropdownHeight:"auto",dropdownParent:void 0,loading:angular.noop,data:angular.noop,loadingComplete:angular.noop,renderItem:angular.noop,itemSelected:angular.noop,dropdownShown:angular.noop,dropdownHidden:angular.noop},r={containerCssClass:{def:"undefined",doc:"CSS class applied to the dropdown container"},selectedCssClass:{def:"auto-complete-item-selected",doc:"CSS class applied to the selected list element"},minimumChars:{def:"1",doc:"Minimum number of characters required to display the dropdown."},maxItemsToRender:{def:"20",doc:"Maximum number of items to render in the list."},dropdownWidth:{def:"auto",doc:"Width in 'px' of the dropddown list."},dropdownHeight:{def:"auto",doc:"Height in 'px' of the dropddown list."},dropdownParent:{def:"undefined",doc:"a jQuery object to append the dropddown list."},loading:{def:"noop",doc:"Callback before getting the data for the dropdown."},data:{def:"noop",doc:"Callback for data for the dropdown. Must return a promise"},loadingComplete:{def:"noop",doc:"Callback after the items are rendered in the dropdown."},renderItem:{def:"noop",doc:"Callback for custom rendering a list item. This is called for each item in the dropdown. It must return an object literal with 'value' and 'label' properties, where label is the safe html for display and value is the text for the textbox"},itemSelected:{def:"noop",doc:"Callback after an item is selected from the dropdown."},dropdownShown:{def:"noop",doc:"Callback after the dropdown is hidden."},dropdownHidden:{def:"noop",doc:"Callback after the dropdown is shown."}}}();